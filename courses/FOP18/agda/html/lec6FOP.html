<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>lec6FOP</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">{- 
  Mathematical Foundations of Programming (G54FOP)
  Nicolai Kraus
  Lecture 6, 15 Feb 2018
-}</a>

<a id="101" class="Keyword">module</a> <a id="108" href="lec6FOP.html" class="Module">lec6FOP</a> <a id="116" class="Keyword">where</a>

<a id="123" class="Comment">{- We import everything we have done last week.
   &quot;open&quot; means we can use all definitions directly -}</a>
<a id="226" class="Keyword">open</a> <a id="231" class="Keyword">import</a> <a id="238" href="lec3FOP.html" class="Module">lec3FOP</a>

<a id="247" class="Comment">{- Hint: middle mouse click or alt-.
   [press alt/meta, then .]
   jumps to the definition that the cursor is on -}</a>

<a id="365" class="Comment">-- Reduce in one step</a>
<a id="387" class="Comment">-- (these are the simplification rules)</a>
<a id="427" class="Keyword">data</a> <a id="432" href="lec6FOP.html#432" class="Datatype Operator">_→1_</a> <a id="437" class="Symbol">:</a> <a id="439" href="lec3FOP.html#1938" class="Datatype">Expr</a> <a id="444" class="Symbol">→</a> <a id="446" href="lec3FOP.html#1938" class="Datatype">Expr</a> <a id="451" class="Symbol">→</a> <a id="453" class="PrimitiveType">Set</a> <a id="457" class="Keyword">where</a>
  <a id="465" href="lec6FOP.html#465" class="InductiveConstructor">izz</a> <a id="469" class="Symbol">:</a> <a id="471" href="lec3FOP.html#2038" class="InductiveConstructor">iz</a> <a id="474" href="lec3FOP.html#1985" class="InductiveConstructor">z</a> <a id="476" href="lec6FOP.html#432" class="Datatype Operator">→1</a> <a id="479" href="lec3FOP.html#1959" class="InductiveConstructor">t</a>
  <a id="483" href="lec6FOP.html#483" class="InductiveConstructor">izs</a> <a id="487" class="Symbol">:</a> <a id="489" class="Symbol">{</a><a id="490" href="lec6FOP.html#490" class="Bound">e</a> <a id="492" class="Symbol">:</a> <a id="494" href="lec3FOP.html#1938" class="Datatype">Expr</a><a id="498" class="Symbol">}</a> <a id="500" class="Symbol">→</a> <a id="502" href="lec3FOP.html#2038" class="InductiveConstructor">iz</a> <a id="505" class="Symbol">(</a><a id="506" href="lec3FOP.html#1998" class="InductiveConstructor">s</a> <a id="508" href="lec6FOP.html#490" class="Bound">e</a><a id="509" class="Symbol">)</a> <a id="511" href="lec6FOP.html#432" class="Datatype Operator">→1</a> <a id="514" href="lec3FOP.html#1972" class="InductiveConstructor">f</a>
  <a id="518" href="lec6FOP.html#518" class="InductiveConstructor">ift</a> <a id="522" class="Symbol">:</a> <a id="524" class="Symbol">{</a><a id="525" href="lec6FOP.html#525" class="Bound">e₂</a> <a id="528" href="lec6FOP.html#528" class="Bound">e₃</a> <a id="531" class="Symbol">:</a> <a id="533" href="lec3FOP.html#1938" class="Datatype">Expr</a><a id="537" class="Symbol">}</a> <a id="539" class="Symbol">→</a> <a id="541" class="Symbol">(</a><a id="542" href="lec3FOP.html#2059" class="InductiveConstructor Operator">if</a> <a id="545" href="lec3FOP.html#1959" class="InductiveConstructor">t</a> <a id="547" href="lec3FOP.html#2059" class="InductiveConstructor Operator">then</a> <a id="552" href="lec6FOP.html#525" class="Bound">e₂</a> <a id="555" href="lec3FOP.html#2059" class="InductiveConstructor Operator">else</a> <a id="560" href="lec6FOP.html#528" class="Bound">e₃</a><a id="562" class="Symbol">)</a> <a id="564" href="lec6FOP.html#432" class="Datatype Operator">→1</a> <a id="567" href="lec6FOP.html#525" class="Bound">e₂</a>
  <a id="572" href="lec6FOP.html#572" class="InductiveConstructor">iff</a> <a id="576" class="Symbol">:</a> <a id="578" class="Symbol">{</a><a id="579" href="lec6FOP.html#579" class="Bound">e₂</a> <a id="582" href="lec6FOP.html#582" class="Bound">e₃</a> <a id="585" class="Symbol">:</a> <a id="587" href="lec3FOP.html#1938" class="Datatype">Expr</a><a id="591" class="Symbol">}</a> <a id="593" class="Symbol">→</a> <a id="595" class="Symbol">(</a><a id="596" href="lec3FOP.html#2059" class="InductiveConstructor Operator">if</a> <a id="599" href="lec3FOP.html#1972" class="InductiveConstructor">f</a> <a id="601" href="lec3FOP.html#2059" class="InductiveConstructor Operator">then</a> <a id="606" href="lec6FOP.html#579" class="Bound">e₂</a> <a id="609" href="lec3FOP.html#2059" class="InductiveConstructor Operator">else</a> <a id="614" href="lec6FOP.html#582" class="Bound">e₃</a><a id="616" class="Symbol">)</a> <a id="618" href="lec6FOP.html#432" class="Datatype Operator">→1</a> <a id="621" href="lec6FOP.html#582" class="Bound">e₃</a>
  <a id="626" href="lec6FOP.html#626" class="InductiveConstructor">ps</a>  <a id="630" class="Symbol">:</a> <a id="632" class="Symbol">{</a><a id="633" href="lec6FOP.html#633" class="Bound">e</a> <a id="635" class="Symbol">:</a> <a id="637" href="lec3FOP.html#1938" class="Datatype">Expr</a><a id="641" class="Symbol">}</a> <a id="643" class="Symbol">→</a> <a id="645" href="lec3FOP.html#2018" class="InductiveConstructor">p</a> <a id="647" class="Symbol">(</a><a id="648" href="lec3FOP.html#1998" class="InductiveConstructor">s</a> <a id="650" href="lec6FOP.html#633" class="Bound">e</a><a id="651" class="Symbol">)</a> <a id="653" href="lec6FOP.html#432" class="Datatype Operator">→1</a> <a id="656" href="lec6FOP.html#633" class="Bound">e</a>
  <a id="660" href="lec6FOP.html#660" class="InductiveConstructor">pz</a>  <a id="664" class="Symbol">:</a> <a id="666" href="lec3FOP.html#2018" class="InductiveConstructor">p</a> <a id="668" href="lec3FOP.html#1985" class="InductiveConstructor">z</a> <a id="670" href="lec6FOP.html#432" class="Datatype Operator">→1</a> <a id="673" href="lec3FOP.html#1985" class="InductiveConstructor">z</a>

<a id="676" class="Comment">-- include structural rules</a>
<a id="704" class="Keyword">data</a> <a id="709" href="lec6FOP.html#709" class="Datatype Operator">_↝_</a> <a id="713" class="Symbol">:</a> <a id="715" href="lec3FOP.html#1938" class="Datatype">Expr</a> <a id="720" class="Symbol">→</a> <a id="722" href="lec3FOP.html#1938" class="Datatype">Expr</a> <a id="727" class="Symbol">→</a> <a id="729" class="PrimitiveType">Set</a> <a id="733" class="Keyword">where</a>  <a id="740" class="Comment">-- type: \leadsto</a>
  <a id="760" href="lec6FOP.html#760" class="InductiveConstructor">from→1</a>   <a id="769" class="Symbol">:</a> <a id="771" class="Symbol">{</a><a id="772" href="lec6FOP.html#772" class="Bound">e₁</a> <a id="775" href="lec6FOP.html#775" class="Bound">e₂</a> <a id="778" class="Symbol">:</a> <a id="780" href="lec3FOP.html#1938" class="Datatype">Expr</a><a id="784" class="Symbol">}</a> <a id="786" class="Symbol">→</a> <a id="788" class="Symbol">(</a><a id="789" href="lec6FOP.html#772" class="Bound">e₁</a> <a id="792" href="lec6FOP.html#432" class="Datatype Operator">→1</a> <a id="795" href="lec6FOP.html#775" class="Bound">e₂</a><a id="797" class="Symbol">)</a> <a id="799" class="Symbol">→</a> <a id="801" class="Symbol">(</a><a id="802" href="lec6FOP.html#772" class="Bound">e₁</a> <a id="805" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="807" href="lec6FOP.html#775" class="Bound">e₂</a><a id="809" class="Symbol">)</a>
  <a id="813" href="lec6FOP.html#813" class="InductiveConstructor">inside-s</a> <a id="822" class="Symbol">:</a> <a id="824" class="Symbol">{</a><a id="825" href="lec6FOP.html#825" class="Bound">e₁</a> <a id="828" href="lec6FOP.html#828" class="Bound">e₂</a> <a id="831" class="Symbol">:</a> <a id="833" href="lec3FOP.html#1938" class="Datatype">Expr</a><a id="837" class="Symbol">}</a> <a id="839" class="Symbol">→</a> <a id="841" class="Symbol">(</a><a id="842" href="lec6FOP.html#825" class="Bound">e₁</a> <a id="845" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="847" href="lec6FOP.html#828" class="Bound">e₂</a><a id="849" class="Symbol">)</a> <a id="851" class="Symbol">→</a> <a id="853" class="Symbol">(</a><a id="854" href="lec3FOP.html#1998" class="InductiveConstructor">s</a> <a id="856" href="lec6FOP.html#825" class="Bound">e₁</a> <a id="859" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="861" href="lec3FOP.html#1998" class="InductiveConstructor">s</a> <a id="863" href="lec6FOP.html#828" class="Bound">e₂</a><a id="865" class="Symbol">)</a>
  <a id="869" href="lec6FOP.html#869" class="InductiveConstructor">inside-p</a> <a id="878" class="Symbol">:</a> <a id="880" class="Symbol">{</a><a id="881" href="lec6FOP.html#881" class="Bound">e₁</a> <a id="884" href="lec6FOP.html#884" class="Bound">e₂</a> <a id="887" class="Symbol">:</a> <a id="889" href="lec3FOP.html#1938" class="Datatype">Expr</a><a id="893" class="Symbol">}</a> <a id="895" class="Symbol">→</a> <a id="897" class="Symbol">(</a><a id="898" href="lec6FOP.html#881" class="Bound">e₁</a> <a id="901" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="903" href="lec6FOP.html#884" class="Bound">e₂</a><a id="905" class="Symbol">)</a> <a id="907" class="Symbol">→</a> <a id="909" class="Symbol">(</a><a id="910" href="lec3FOP.html#2018" class="InductiveConstructor">p</a> <a id="912" href="lec6FOP.html#881" class="Bound">e₁</a> <a id="915" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="917" href="lec3FOP.html#2018" class="InductiveConstructor">p</a> <a id="919" href="lec6FOP.html#884" class="Bound">e₂</a><a id="921" class="Symbol">)</a>
  <a id="925" href="lec6FOP.html#925" class="InductiveConstructor">inside-iz</a> <a id="935" class="Symbol">:</a> <a id="937" class="Symbol">∀</a> <a id="939" class="Symbol">{</a><a id="940" href="lec6FOP.html#940" class="Bound">e₁</a><a id="942" class="Symbol">}</a> <a id="944" class="Symbol">{</a><a id="945" href="lec6FOP.html#945" class="Bound">e₂</a><a id="947" class="Symbol">}</a> <a id="949" class="Symbol">→</a> <a id="951" class="Symbol">(</a><a id="952" href="lec6FOP.html#940" class="Bound">e₁</a> <a id="955" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="957" href="lec6FOP.html#945" class="Bound">e₂</a><a id="959" class="Symbol">)</a> <a id="961" class="Symbol">→</a> <a id="963" class="Symbol">(</a><a id="964" href="lec3FOP.html#2038" class="InductiveConstructor">iz</a> <a id="967" href="lec6FOP.html#940" class="Bound">e₁</a> <a id="970" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="972" href="lec3FOP.html#2038" class="InductiveConstructor">iz</a> <a id="975" href="lec6FOP.html#945" class="Bound">e₂</a><a id="977" class="Symbol">)</a>
  <a id="981" href="lec6FOP.html#981" class="InductiveConstructor">inside-ite1</a> <a id="993" class="Symbol">:</a> <a id="995" class="Symbol">∀</a> <a id="997" class="Symbol">{</a><a id="998" href="lec6FOP.html#998" class="Bound">e₁</a> <a id="1001" href="lec6FOP.html#1001" class="Bound">e₁&#39;</a> <a id="1005" href="lec6FOP.html#1005" class="Bound">e₂</a> <a id="1008" href="lec6FOP.html#1008" class="Bound">e₃</a><a id="1010" class="Symbol">}</a> <a id="1012" class="Symbol">→</a> <a id="1014" class="Symbol">(</a><a id="1015" href="lec6FOP.html#998" class="Bound">e₁</a> <a id="1018" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="1020" href="lec6FOP.html#1001" class="Bound">e₁&#39;</a><a id="1023" class="Symbol">)</a>
    <a id="1029" class="Symbol">→</a> <a id="1031" class="Symbol">(</a><a id="1032" href="lec3FOP.html#2059" class="InductiveConstructor Operator">if</a> <a id="1035" href="lec6FOP.html#998" class="Bound">e₁</a> <a id="1038" href="lec3FOP.html#2059" class="InductiveConstructor Operator">then</a> <a id="1043" href="lec6FOP.html#1005" class="Bound">e₂</a> <a id="1046" href="lec3FOP.html#2059" class="InductiveConstructor Operator">else</a> <a id="1051" href="lec6FOP.html#1008" class="Bound">e₃</a><a id="1053" class="Symbol">)</a> <a id="1055" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="1057" class="Symbol">(</a><a id="1058" href="lec3FOP.html#2059" class="InductiveConstructor Operator">if</a> <a id="1061" href="lec6FOP.html#1001" class="Bound">e₁&#39;</a> <a id="1065" href="lec3FOP.html#2059" class="InductiveConstructor Operator">then</a> <a id="1070" href="lec6FOP.html#1005" class="Bound">e₂</a> <a id="1073" href="lec3FOP.html#2059" class="InductiveConstructor Operator">else</a> <a id="1078" href="lec6FOP.html#1008" class="Bound">e₃</a><a id="1080" class="Symbol">)</a>
  <a id="1084" href="lec6FOP.html#1084" class="InductiveConstructor">inside-ite2</a> <a id="1096" class="Symbol">:</a> <a id="1098" class="Symbol">∀</a> <a id="1100" class="Symbol">{</a><a id="1101" href="lec6FOP.html#1101" class="Bound">e₁</a> <a id="1104" href="lec6FOP.html#1104" class="Bound">e₂</a> <a id="1107" href="lec6FOP.html#1107" class="Bound">e₂&#39;</a> <a id="1111" href="lec6FOP.html#1111" class="Bound">e₃</a><a id="1113" class="Symbol">}</a> <a id="1115" class="Symbol">→</a> <a id="1117" class="Symbol">(</a><a id="1118" href="lec6FOP.html#1104" class="Bound">e₂</a> <a id="1121" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="1123" href="lec6FOP.html#1107" class="Bound">e₂&#39;</a><a id="1126" class="Symbol">)</a>
    <a id="1132" class="Symbol">→</a> <a id="1134" class="Symbol">(</a><a id="1135" href="lec3FOP.html#2059" class="InductiveConstructor Operator">if</a> <a id="1138" href="lec6FOP.html#1101" class="Bound">e₁</a> <a id="1141" href="lec3FOP.html#2059" class="InductiveConstructor Operator">then</a> <a id="1146" href="lec6FOP.html#1104" class="Bound">e₂</a> <a id="1149" href="lec3FOP.html#2059" class="InductiveConstructor Operator">else</a> <a id="1154" href="lec6FOP.html#1111" class="Bound">e₃</a><a id="1156" class="Symbol">)</a> <a id="1158" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="1160" class="Symbol">(</a><a id="1161" href="lec3FOP.html#2059" class="InductiveConstructor Operator">if</a> <a id="1164" href="lec6FOP.html#1101" class="Bound">e₁</a> <a id="1167" href="lec3FOP.html#2059" class="InductiveConstructor Operator">then</a> <a id="1172" href="lec6FOP.html#1107" class="Bound">e₂&#39;</a> <a id="1176" href="lec3FOP.html#2059" class="InductiveConstructor Operator">else</a> <a id="1181" href="lec6FOP.html#1111" class="Bound">e₃</a><a id="1183" class="Symbol">)</a>
  <a id="1187" href="lec6FOP.html#1187" class="InductiveConstructor">inside-ite3</a> <a id="1199" class="Symbol">:</a> <a id="1201" class="Symbol">∀</a> <a id="1203" class="Symbol">{</a><a id="1204" href="lec6FOP.html#1204" class="Bound">e₁</a> <a id="1207" href="lec6FOP.html#1207" class="Bound">e₂</a> <a id="1210" href="lec6FOP.html#1210" class="Bound">e₃</a> <a id="1213" href="lec6FOP.html#1213" class="Bound">e₃&#39;</a><a id="1216" class="Symbol">}</a> <a id="1218" class="Symbol">→</a> <a id="1220" class="Symbol">(</a><a id="1221" href="lec6FOP.html#1210" class="Bound">e₃</a> <a id="1224" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="1226" href="lec6FOP.html#1213" class="Bound">e₃&#39;</a><a id="1229" class="Symbol">)</a>
    <a id="1235" class="Symbol">→</a> <a id="1237" class="Symbol">(</a><a id="1238" href="lec3FOP.html#2059" class="InductiveConstructor Operator">if</a> <a id="1241" href="lec6FOP.html#1204" class="Bound">e₁</a> <a id="1244" href="lec3FOP.html#2059" class="InductiveConstructor Operator">then</a> <a id="1249" href="lec6FOP.html#1207" class="Bound">e₂</a> <a id="1252" href="lec3FOP.html#2059" class="InductiveConstructor Operator">else</a> <a id="1257" href="lec6FOP.html#1210" class="Bound">e₃</a><a id="1259" class="Symbol">)</a> <a id="1261" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="1263" class="Symbol">(</a><a id="1264" href="lec3FOP.html#2059" class="InductiveConstructor Operator">if</a> <a id="1267" href="lec6FOP.html#1204" class="Bound">e₁</a> <a id="1270" href="lec3FOP.html#2059" class="InductiveConstructor Operator">then</a> <a id="1275" href="lec6FOP.html#1207" class="Bound">e₂</a> <a id="1278" href="lec3FOP.html#2059" class="InductiveConstructor Operator">else</a> <a id="1283" href="lec6FOP.html#1213" class="Bound">e₃&#39;</a><a id="1286" class="Symbol">)</a>

<a id="1289" class="Keyword">data</a> <a id="1294" href="lec6FOP.html#1294" class="Datatype Operator">_↝*_</a> <a id="1299" class="Symbol">:</a> <a id="1301" href="lec3FOP.html#1938" class="Datatype">Expr</a> <a id="1306" class="Symbol">→</a> <a id="1308" href="lec3FOP.html#1938" class="Datatype">Expr</a> <a id="1313" class="Symbol">→</a> <a id="1315" class="PrimitiveType">Set</a> <a id="1319" class="Keyword">where</a>
  <a id="1327" href="lec6FOP.html#1327" class="InductiveConstructor">start</a> <a id="1333" class="Symbol">:</a> <a id="1335" class="Symbol">∀</a> <a id="1337" class="Symbol">{</a><a id="1338" href="lec6FOP.html#1338" class="Bound">e</a><a id="1339" class="Symbol">}</a> <a id="1341" class="Symbol">→</a> <a id="1343" href="lec6FOP.html#1338" class="Bound">e</a> <a id="1345" href="lec6FOP.html#1294" class="Datatype Operator">↝*</a> <a id="1348" href="lec6FOP.html#1338" class="Bound">e</a>
  <a id="1352" href="lec6FOP.html#1352" class="InductiveConstructor">step</a>  <a id="1358" class="Symbol">:</a> <a id="1360" class="Symbol">∀</a> <a id="1362" class="Symbol">{</a><a id="1363" href="lec6FOP.html#1363" class="Bound">e₁</a> <a id="1366" href="lec6FOP.html#1366" class="Bound">e₂</a> <a id="1369" href="lec6FOP.html#1369" class="Bound">e₃</a><a id="1371" class="Symbol">}</a> <a id="1373" class="Symbol">→</a> <a id="1375" class="Symbol">(</a><a id="1376" href="lec6FOP.html#1363" class="Bound">e₁</a> <a id="1379" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="1381" href="lec6FOP.html#1366" class="Bound">e₂</a><a id="1383" class="Symbol">)</a> <a id="1385" class="Symbol">→</a> <a id="1387" class="Symbol">(</a><a id="1388" href="lec6FOP.html#1366" class="Bound">e₂</a> <a id="1391" href="lec6FOP.html#1294" class="Datatype Operator">↝*</a> <a id="1394" href="lec6FOP.html#1369" class="Bound">e₃</a><a id="1396" class="Symbol">)</a>
          <a id="1408" class="Symbol">→</a> <a id="1410" class="Symbol">(</a><a id="1411" href="lec6FOP.html#1363" class="Bound">e₁</a> <a id="1414" href="lec6FOP.html#1294" class="Datatype Operator">↝*</a> <a id="1417" href="lec6FOP.html#1369" class="Bound">e₃</a><a id="1419" class="Symbol">)</a>

<a id="1422" class="Comment">-- compose two reduction sequences</a>
<a id="1457" href="lec6FOP.html#1457" class="Function">compose</a> <a id="1465" class="Symbol">:</a> <a id="1467" class="Symbol">{</a><a id="1468" href="lec6FOP.html#1468" class="Bound">e₁</a> <a id="1471" href="lec6FOP.html#1471" class="Bound">e₂</a> <a id="1474" href="lec6FOP.html#1474" class="Bound">e₃</a> <a id="1477" class="Symbol">:</a> <a id="1479" href="lec3FOP.html#1938" class="Datatype">Expr</a><a id="1483" class="Symbol">}</a> <a id="1485" class="Symbol">→</a> <a id="1487" class="Symbol">(</a><a id="1488" href="lec6FOP.html#1468" class="Bound">e₁</a> <a id="1491" href="lec6FOP.html#1294" class="Datatype Operator">↝*</a> <a id="1494" href="lec6FOP.html#1471" class="Bound">e₂</a><a id="1496" class="Symbol">)</a>
          <a id="1508" class="Symbol">→</a> <a id="1510" class="Symbol">(</a><a id="1511" href="lec6FOP.html#1471" class="Bound">e₂</a> <a id="1514" href="lec6FOP.html#1294" class="Datatype Operator">↝*</a> <a id="1517" href="lec6FOP.html#1474" class="Bound">e₃</a><a id="1519" class="Symbol">)</a>
          <a id="1531" class="Symbol">→</a> <a id="1533" class="Symbol">(</a><a id="1534" href="lec6FOP.html#1468" class="Bound">e₁</a> <a id="1537" href="lec6FOP.html#1294" class="Datatype Operator">↝*</a> <a id="1540" href="lec6FOP.html#1474" class="Bound">e₃</a><a id="1542" class="Symbol">)</a>
<a id="1544" href="lec6FOP.html#1457" class="Function">compose</a> <a id="1552" href="lec6FOP.html#1327" class="InductiveConstructor">start</a> <a id="1558" href="lec6FOP.html#1558" class="Bound">s₂</a> <a id="1561" class="Symbol">=</a> <a id="1563" href="lec6FOP.html#1558" class="Bound">s₂</a>
<a id="1566" href="lec6FOP.html#1457" class="Function">compose</a> <a id="1574" class="Symbol">(</a><a id="1575" href="lec6FOP.html#1352" class="InductiveConstructor">step</a> <a id="1580" href="lec6FOP.html#1580" class="Bound">x</a> <a id="1582" href="lec6FOP.html#1582" class="Bound">s₁</a><a id="1584" class="Symbol">)</a> <a id="1586" href="lec6FOP.html#1586" class="Bound">s₂</a> <a id="1589" class="Symbol">=</a> <a id="1591" href="lec6FOP.html#1352" class="InductiveConstructor">step</a> <a id="1596" href="lec6FOP.html#1580" class="Bound">x</a> <a id="1598" class="Symbol">(</a><a id="1599" href="lec6FOP.html#1457" class="Function">compose</a> <a id="1607" href="lec6FOP.html#1582" class="Bound">s₁</a> <a id="1610" href="lec6FOP.html#1586" class="Bound">s₂</a><a id="1612" class="Symbol">)</a>

<a id="1615" class="Keyword">open</a> <a id="1620" class="Keyword">import</a> <a id="1627" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="1638" class="Keyword">renaming</a> <a id="1647" class="Symbol">(</a><a id="1648" href="Data.Empty.html#243" class="Datatype">⊥</a> <a id="1650" class="Symbol">to</a> <a id="1653" href="Data.Empty.html#243" class="Datatype">∅</a><a id="1654" class="Symbol">)</a>  <a id="1657" class="Comment">-- \emptyset</a>

<a id="1671" class="Comment">-- define what it means to be a normal form</a>
<a id="1715" href="lec6FOP.html#1715" class="Function">is-normal</a> <a id="1725" class="Symbol">:</a> <a id="1727" href="lec3FOP.html#1938" class="Datatype">Expr</a> <a id="1732" class="Symbol">→</a> <a id="1734" class="PrimitiveType">Set</a>
<a id="1738" href="lec6FOP.html#1715" class="Function">is-normal</a> <a id="1748" href="lec6FOP.html#1748" class="Bound">e</a> <a id="1750" class="Symbol">=</a> <a id="1752" class="Symbol">(</a><a id="1753" href="lec6FOP.html#1753" class="Bound">e₁</a> <a id="1756" class="Symbol">:</a> <a id="1758" href="lec3FOP.html#1938" class="Datatype">Expr</a><a id="1762" class="Symbol">)</a> <a id="1764" class="Symbol">→</a> <a id="1766" class="Symbol">(</a><a id="1767" href="lec6FOP.html#1748" class="Bound">e</a> <a id="1769" href="lec6FOP.html#432" class="Datatype Operator">→1</a> <a id="1772" href="lec6FOP.html#1753" class="Bound">e₁</a><a id="1774" class="Symbol">)</a> <a id="1776" class="Symbol">→</a> <a id="1778" href="Data.Empty.html#243" class="Datatype">∅</a>

<a id="1781" class="Comment">{- Exercises:
   1. (easy) Show that the expression &quot;t&quot; is
      in normal form. This means: fill the whole
      (replace the question mark) in
        t-nf : is-normal t
        t-nf = ?

   2. (medium) Show that, if &quot;e&quot; is a normal form,
      then so is &quot;s e&quot;.

   3. (hard) Show that &quot;is-normal&quot; is a
      decidable predicate on Expr. 
      This means writing a function
      which takes an expression and tells us
      whether the expression is a normal form
      or not. The naive version would be
         Expr → Bool
      but we can do much better: we can take an
      expression &quot;e&quot; and either return a *proof*
      that &quot;e&quot; is a normal form, or return an
      example of how it can be reduced.
      Such an example would consist of an expression
      &quot;reduct&quot; and a proof of &quot;e ↝ reduct&quot;; we
      will learn later how this can be expressed,
      but a good way of implementing it is as follows:
-}</a>

<a id="2704" class="Keyword">record</a> <a id="2711" href="lec6FOP.html#2711" class="Record">can-red</a> <a id="2719" class="Symbol">(</a><a id="2720" href="lec6FOP.html#2720" class="Bound">e</a> <a id="2722" class="Symbol">:</a> <a id="2724" href="lec3FOP.html#1938" class="Datatype">Expr</a><a id="2728" class="Symbol">)</a> <a id="2730" class="Symbol">:</a> <a id="2732" class="PrimitiveType">Set</a> <a id="2736" class="Keyword">where</a>
  <a id="2744" class="Keyword">field</a>
    <a id="2754" href="lec6FOP.html#2754" class="Field">reduct</a>  <a id="2762" class="Symbol">:</a> <a id="2764" href="lec3FOP.html#1938" class="Datatype">Expr</a>
    <a id="2773" href="lec6FOP.html#2773" class="Field">redstep</a> <a id="2781" class="Symbol">:</a> <a id="2783" href="lec6FOP.html#2720" class="Bound">e</a> <a id="2785" href="lec6FOP.html#709" class="Datatype Operator">↝</a> <a id="2787" href="lec6FOP.html#2754" class="Field">reduct</a>

<a id="2795" class="Comment">{- Ex 3, continued: We can import Data.Sum to get the
   definition of ⊎ (type: \u+), a disjoint sum (it&#39;s
   Either in Haskell). Check out how ⊎ is defined in
   the library, it&#39;s really simple! -}</a>

<a id="2995" class="Keyword">open</a> <a id="3000" class="Keyword">import</a> <a id="3007" href="Data.Sum.html" class="Module">Data.Sum</a>

<a id="3017" class="Comment">{- Ex3, continued: Now, fill in the ? in the following
   function; probably, you will want more auxiliary
   lemma. Caveat: I have not done this myself. 
   
decide-nf : (e : Expr) → (is-normal e) ⊎ can-red e
decide-nf e = {!!}

-}</a>
</pre></body></html>